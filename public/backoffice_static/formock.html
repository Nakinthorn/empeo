<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon"
        href="https://media.discordapp.net/attachments/1065176955445587988/1123534910381117491/350885243_2871046769695349_6895795451906942072_n.jpg?width=372&height=580">

    <title>Income</title>

    <!-- CSS -->
    <link rel="stylesheet" href="./global.css">
    <script src="./global.js"></script>

    <!-- Fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css"
        integrity="sha512-YWzhKL2whUzgiheMoBFwW8CKV4qpHQAEuvilg9FAn5VJUDwKZZxkJNuGM4XkWuk94WCrrwslk8yWNGmY1EduTA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Swal2 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.0.11/sweetalert2.all.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"
        integrity="sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.7.0.js"
        integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>

    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>

    <!-- CSS -->
    <link rel="stylesheet" href="./global_hrm.css" />

    <!-- Global JS -->
    <script src='./global_js.js'></script>
    <script src="config.js"></script>
    <!-- This css font  -->
    <link
        href="https://fonts.googleapis.com/css2?family=Kanit:wght@100;200;300;400;500&family=Poppins:wght@100;200;300;400;500;600;700;800;900&family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100&display=swap"
        rel="stylesheet">


</head>
<style>
    html,
    body {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    * {
        margin: 0;
        padding: 0;
    }

    .income-body {
        margin-left: 5vw;
        padding: 20px;
    }

    .head-income {
        width: 100%;
        height: 100px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .head-right {
        display: flex;
        width: 20%;
        justify-content: end;
        padding-right: 25px;
    }

    .text-right {
        align-items: center;
        display: flex;
        color: #F47243;
    }

    .text-right img {
        height: 20px;
        margin-right: 10px;
    }

    .div-table {
        height: calc(100vh - 85px - 60px - 185px);
        overflow: scroll;
        padding: 0 25px;
    }

    .tab {
        display: inline-block;
        padding: 10px 20px;
        cursor: pointer;
    }

    .tab.active {
        color: #007268;
        border-bottom: #007268 3px solid;
    }

    .tab.default {
        color: #007268;
    }

    /* Style the tab content */
    .tab-content {
        display: none;
        padding: 20px;
    }

    .search-add {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-right: 12vw;
    }

    .add-field {
        display: flex;
        gap: 20px;
    }

    .search-icon {
        position: absolute;
        top: 50%;
        left: 10px;
        transform: translateY(-50%);
    }

    .input-search {
        width: 366px;
        height: 5vh;
        height: -1vh;
        padding-left: 30px;
        border-radius: 13px;
        border: 1px solid grey;
    }

    .input_box1 {
        border: 1px solid grey;
        padding: 12px 16px;
        border-radius: 13px;
    }

    .input_box1 p {
        color: grey;
    }

    .add-data {
        border: none;
        padding: 13px 16px;
        width: 7vw;
        border-radius: 13px;
        background: #007268;
        cursor: pointer;
        position: absolute;
        right: 43px;
        top: 245px;
    }

    .add-data p {
        color: #fff;
    }

    table {
        border-collapse: collapse;
        width: 100%;
        text-align: left;
        border-radius: 10px;
        overflow: hidden;
    }

    thead {
        background-color: lightgrey;
    }

    thead th {
        padding: 13px;
    }

    .icon {
        display: flex;
    }

    #overlayIncome {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 9999;
    }

    #overlayIncomeContent {
        background-color: white;
        width: 400px;
        position: fixed;
        right: 0;
        height: 100%;
    }

    #editOverlayIncome {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 9999;
    }

    #editOverlayIncomeContent {
        background-color: white;
        width: 400px;
        position: fixed;
        right: 0;
        height: 100%;
    }

    #overlayDeduction {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 9999;
    }

    #overlayDeductionContent {
        background-color: white;
        width: 400px;
        position: fixed;
        right: 0;
        height: 100%;
    }

    #editDeductionOverlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 9999;
    }

    #editOverlayDeductionContent {
        background-color: white;
        width: 400px;
        position: fixed;
        right: 0;
        height: 100%;
    }

    .section-income {
        display: flex;
        justify-content: space-between;
        padding: 20px;
    }

    .x-btn {
        background: none;
        border: none;
        font-size: 24px;
        font-weight: 500;
        cursor: pointer;
    }
</style>

<body style="overflow: hidden;">
    <script>
        $.get("./menu-top.html", function (data) {
            $("#sidebar-tabtop").html(data);
        });
    </script>
    <script>
        $.get("./menu-left.html", function (data) {
            $("#sidebar-tableft").html(data);
        });
    </script>

    <div id="sidebar-tableft"></div>
    <div style="width: calc(100% - 60px);">
        <div id="sidebar-tabtop">

        </div>
        <div>

        </div>
    </div>
    <div class="income-body">

        <div class="head-income">
            <div class="font_xl">ตั้งค่ารายได้รายหัก</div>
            <div class="head-right">
                <div class="font_normal text-right">
                    <img src="./symbol_hrm/scanandpay_copy_icon_pin.png" />
                    ดูวีดีโอ
                </div>
                <div class="font_normal text-right">
                    <img src="./symbol_hrm/scanandpay_copy_icon_pin.png" />
                    คู่มือการใช้งาน
                </div>
            </div>
        </div>

        <div>
            <div class="tab" onclick="changeTab(0)">รายได้</div>
            <div class="tab" onclick="changeTab(1)">รายหัก</div>
        </div>
        <hr>

        <div id="income" class="tab-content" style="display: block;">
            <div class="search-add">
                <div style="position: relative;">
                    <input class="input-search" type="text" placeholder="ค้นหารายชื่อได้ หรือรหัสรายได้">
                    <i class="search-icon fas fa-search" style="color: grey;"></i>
                </div>
                <div class="add-field">
                    <div class="input_box1">
                        <p>Company</p>
                    </div>
                    <div class="input_box1">
                        <p>ใช้งาน</p>
                    </div>
                </div>
            </div>
            <br>
            <div>
                <div class="add-data" onclick="addIncomeOverlay()">
                    <p>+ เพิ่มรายได้</p>
                </div>
                <table id="incomeTable">
                    <thead>
                        <tr>
                            <th>รหัส</th>
                            <th>รายได้</th>
                            <th>ประเภท</th>
                            <th>คำนวณภาษี</th>
                            <th>นอกงวด</th>
                            <th>งวดถัดไป</th>
                            <th>ทำจ่าย</th>
                            <th>ประเภทรหัสบัญชี</th>
                            <th>คำนวณกับ</th>
                            <th>สวัสดิการ</th>
                            <th>สถานะ </th>
                            <th></th>
                        </tr>
                    </thead>

                </table>
            </div>

            <div id="overlayIncome">
                <div id="overlayIncomeContent">
                    <div class="section-income">
                        <h3>เพิ่มรายได้</h3>
                        <button class="x-btn" onclick="closeOverlayIncome()">X</button>
                    </div>
                    <hr>

                    <div style="padding: 20px;">
                        <div>
                            <p>รหัส</p>
                            <input type="text">
                        </div>
                        <div>
                            <p>ชื่อรายได้*</p>
                            <input type="text">
                        </div>
                        <div>
                            <p>ประเภท</p>
                            <input type="text">
                        </div>
                        <br>
                        <div>
                            <p>การคำนวนภาษี</p>
                            <form>
                                <div style="display: flex;">
                                    <input type="radio" name="calTax" value="ทั้งปี">
                                    <p style="padding-left: 10px;">ทั้งปี</p>
                                </div>
                                <div style="display: flex;">
                                    <input type="radio" name="calTax" value="ครั้งเดียว">
                                    <p style="padding-left: 10px;">ครั้งเดียว</p>
                                </div>
                            </form>
                        </div>
                        <br>
                        <div>
                            <p>ทำจ่าย</p>
                            <form>
                                <div style="display: flex;">
                                    <input type="radio" name="pay" value="ทุกงวด">
                                    <p style="padding-left: 10px;">ทุกงวด</p>
                                </div>
                                <div style="display: flex;">
                                    <input type="radio" name="pay" value="งวดสิ้นเดือน">
                                    <p style="padding-left: 10px;">งวดสิ้นเดือน</p>
                                </div>
                            </form>
                        </div>

                       
                    </div>



                </div>
            </div>

            <div id="editOverlayIncome">
                <div id="editOverlayIncomeContent">
                    <h2>This is an editOverlayDeduction</h2>
                    <p>Overlay content goes here...</p>
                    <button onclick="closeEditOverlayIncome()">Close</button>
                </div>
            </div>

        </div>

        <div id="deduction" class="tab-content">
            <div class="search-add">
                <div style="position: relative;">
                    <input class="input-search" type="text" placeholder="ค้นหารายชื่อหัก หรือรหัสรายหัก">
                    <i class="search-icon fas fa-search" style="color: grey;"></i>
                </div>
                <div class="add-field">
                    <div class="input_box1">
                        <p>Company</p>
                    </div>
                    <div class="input_box1">
                        <p>ใช้งาน</p>
                    </div>

                </div>
            </div>
            <br>
            <div>
                <div class="add-data" onclick="addDeductionOverlay();">
                    <p>+ เพิ่มรายหัก</p>
                </div>
                <table id="deductionTable">
                    <thead>
                        <tr>
                            <th>รหัส</th>
                            <th>รายหัก</th>
                            <th>คำนวณภาษี</th>
                            <th>นอกงวด</th>
                            <th>งวดถัดไป</th>
                            <th>ทำจ่าย</th>
                            <th>ประเภทรหัสบัญชี</th>
                            <th>คำนวณกับ</th>
                            <th>สวัสดิการ</th>
                            <th>สถานะ</th>
                            <th></th>
                        </tr>
                    </thead>

                </table>
            </div>

            <div id="overlayDeduction">
                <div id="overlayDeductionContent">
                    <h2>This is an overlay Deduction</h2>
                    <p>Overlay content goes here...</p>
                    <button onclick="closeOverlayDeduction()">Close</button>
                </div>
            </div>

            <div id="editDeductionOverlay">
                <div id="editOverlayDeductionContent">
                    <h2>This is an fffff</h2>
                    <p>Overlay content goes here...</p>
                    <button onclick="closeEditOverlayDeduction()">Close</button>
                </div>
            </div>

        </div>

    </div>

    <script>
        let ENDPOINT = window.API_URL;

        function changeTab(tabIndex) {
            var tabs = document.getElementsByClassName("tab");
            var contents = document.getElementsByClassName("tab-content");

            var i = 0;
            while (i < tabs.length) {
                tabs[i].classList.remove("active");
                contents[i].style.display = "none";
                i++;
            }
            contents[tabIndex].style.display = "block";
            tabs[tabIndex].classList.add("active");
        }


        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        var raw = JSON.stringify({
            "token": localStorage.token
        });

        var requestOptions = {
            method: 'POST',
            headers: myHeaders,
            body: raw,
            redirect: 'follow'
        };

        fetch(ENDPOINT + "api/getData", requestOptions)
            .then(response => {
                return response.json()
            })
            .then(result => {
                const incomeTable = document.getElementById("incomeTable");
                let incomeHTML = '';
                for (let i in result.income) {
                    const income = result.income[i];
                    console.log(income);
                    incomeHTML += `
                        <tbody>
                            <tr>
                                <td>${income.code}</td>
                                <td>${income.income}</td>
                                <td>${income.type}</td>
                                <td>${income.cal_tax}</td>
                                <td>${income.out_of_period}</td>
                                <td>${income.next_period}</td>
                                <td>${income.pay}</td>
                                <td>-</td>
                                <td>
                                    <div class="icon">
                                        <p>${income.security_social_fund}</p>
                                        <p>${income.provident_fund}</p>
                                        <p>${income.overtime}</p>
                                        <p>${income.late_missing}</p>
                                    </div>
                                </td>
                                <td>${income.welfare_benefit}</td>
                                <td>${income.status}</td>
                                <td>
                                    <img src="./symbol_hrm/edit.png" width="30px" onclick="editIncomeOverlay();">
                                </td>
                            </tr>
                        </tbody>
                    `;
                }
                incomeTable.innerHTML += incomeHTML;

                const deductionTable = document.getElementById("deductionTable");
                let deductionHTML = '';
                for (let d in result.deduction) {
                    const deduction = result.deduction[d];
                    console.log(deduction);
                    deductionHTML += `
                        <tbody>
                            <tr>
                                <td>${deduction.du_code}</td>
                                <td>${deduction.deduction}</td>
                                <td>${deduction.du_cal_tax}</td>
                                <td>${deduction.du_out_of_period}</td>
                                <td>${deduction.du_next_period}</td>
                                <td>${deduction.du_pay}</td>
                                <td>-</td>
                                <td>
                                    <div class="icon">
                                        <p>${deduction.du_security_social_fund}</p>
                                        <p>${deduction.du_provident_fund}</p>
                                    </div>
                                </td>
                                <td>${deduction.du_welfare_benefit}</td>
                                <td>${deduction.du_status}</td>
                                <td>
                                    <img src="./symbol_hrm/edit.png" width="30px" onclick="editDeductionOverlay();">
                                </td>
                            </tr>
                        </tbody>
                    `;
                }
                deductionTable.innerHTML += deductionHTML;
            })
            .catch(error => {
                console.log('error', error)
            });

        function addIncomeOverlay() {
            var overlayIncome = document.getElementById('overlayIncome');
            overlayIncome.style.display = 'block';
        }

        function closeOverlayIncome() {
            var overlayIncome = document.getElementById('overlayIncome');
            overlayIncome.style.display = 'none';
        }

        function editIncomeOverlay() {
            var editOverlayIncome = document.getElementById('editOverlayIncome');
            editOverlayIncome.style.display = 'block';
        }

        function closeEditOverlayIncome() {
            var editOverlayIncome = document.getElementById('editOverlayIncome');
            editOverlayIncome.style.display = 'none';
        }


        function addDeductionOverlay() {
            var overlayDeduction = document.getElementById('overlayDeduction');
            overlayDeduction.style.display = 'block';
        }

        function closeOverlayDeduction() {
            var overlayDeduction = document.getElementById('overlayDeduction');
            overlayDeduction.style.display = 'none';
        }

        function editDeductionOverlay() {
            var editDeductionOverlay = document.getElementById('editDeductionOverlay');
            editDeductionOverlay.style.display = 'block';
        }

        function closeEditOverlayDeduction() {
            var editDeductionOverlay = document.getElementById('editDeductionOverlay');
            editDeductionOverlay.style.display = 'none';
        }

    </script>




</body>

</html>